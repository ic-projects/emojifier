#!/usr/bin/env python
# -*- coding: utf-8 -*-

from __future__ import print_function
import numpy as np
import tensorflow as tf

import argparse
import time
import os
from six.moves import cPickle

from utils import TextLoader
from model import Model

from six import text_type
import os

import sys
reload(sys)
sys.setdefaultencoding('UTF8')

def main():
    initializeModel()

def initializeModel():
    cwd = os.getcwd()
    save_dir = cwd + "/save/"
    print(save_dir)
    with open(os.path.join(save_dir, 'config.pkl'), 'rb') as f:
        saved_args = cPickle.load(f)
    with open(os.path.join(save_dir, 'chars_vocab.pkl'), 'rb') as f:
        chars, vocab = cPickle.load(f)
    model = Model(saved_args, True, useDropout=False)
    with tf.Session() as sess:
        tf.initialize_all_variables().run()
        saver = tf.train.Saver(tf.all_variables())
        ckpt = tf.train.get_checkpoint_state(save_dir)
        if ckpt and ckpt.model_checkpoint_path:
            saver.restore(sess, ckpt.model_checkpoint_path)
            print("Initalized")
            message = ""
            while(message != "exit"):
                message = raw_input("Type your stuff:")
                print(message)
                print(sample(message, chars, sess, vocab, model))

emojis = ['👌', '😂', '👀', '😍', '💯', '✔', '🎃', '❤', '🔥', '💦', '👍', '👏', '😭', '👻', '💩', '🏻', '👎', '🐸', '😊', '👋', '🍕', '😉', '🏿', '☑', '🔫', '🏼', '😘', '👴', '🍆', '👭', '♥', '🎶', '🔝', '😎', '🌃', '🎺', '😁', '🙏', '🔪', '🇺', '🇸', '😢', '🙌', '😏', '😩', '💖', '😀', '🚫', '☺', '😱', '❌', '😜', '👅', '💀', '💉', '😄', '🏽', '❗', '😅', '😆', '💕', '🎵', '🙇', '💪', '🏾', '🎩', '😈', '😃', '😡', '👉', '❓', '👽', '😳', '🍅', '‍', '👊', '🐍', '✋', '😑', '🚨', '👟', '🎉', '😋', '😬', '🇧', '♊', '🇬', '✌', '🐃', '❄', '⃣', '😔', '📅', '😛', '🍑', '💃', '‼', '🆗', '😫', '😤', '😞', '🌊', '💰', '😝', '🍍', '💋', '💜', '👨', '😐', '😒', '😠', '💘', '🔑', '🙈', '🍴', '💥', '👦', '💙', '✖', '😇', '😥', '👈', '✊', '✨', '☀', '😕', '💁', '😻', '😮', '🚬', '💍', '👓', '🙅', '🆙', '💨', '🅰', '😲', '😵', '😷', '🤔', '⚡', '😨', '👪', '🏢', '☝', '👮', '💒', '💾', '⭐', '😰', '👑', '💣', '💻', '🐻', '👆', '🇹', '👩', '⬆', '🙊', '👳', '✈', '🎈', '☁', '🔔', '✅', '🍁', '😣', '😚', '😖', '💗', '🎂', '🐒', '🙋', '😹', '💚', '🌟', '💧', '🇮', '🖕', '⬇', '🍻', '🌹', '☠', '👶', '🍇', '😙', '▶', '🐛', '👼', '🐐', '🇨', '👧', '😦', '➡', '😓', '💸', '🏃', '💔', '😴', '👄', '😽', '🐶', '🍌', '🍺', '😌', '😧', '⬛', '🚂', '🍓', '🎤', '😪', '🍝', '🤑', '🐔', '💵', '🇦', '👐', '👇', '👿', '🇷', '💛', '👹', '🇲', '🐝', '🏆', '💫', '🌚', '🍋', '🐱', '⚠', '💞', '🌽', '💲', '😯', '👬', '😶', '💓', '🚀', '😟', '🍞', '☕', '🐓', '🍀', '🎷', '🐧', '🙀', '💤', '🤗', '🌈', '🇪', '🎊', '🎼', '🙆', '👖', '🌌', '💎', '🙉', '🚃', '🍪', '👱', '💇', '💢', '🌎', '💺', '🌞', '🗽', '🍟', '🍔', '🐴', '🇳', '🦄', '🛰', '💏', '🍎', '🍗', '🔛', '🔭', '🙄', '🍰', '💊', '🐼', '📝', '😸', '🌙', '♻', '🔨', '▪', '👯', '👁', '🌿', '🐕', '🙃', '🌍', '🗣', '👺', '🌲', '🏀', '🇵', '🇩', '🌴', '😗', '😺', '👸', '🐳', '🚲', '📢', '🍩', '👂', '👫', '⚾', '🆘', '🍷', '🚚', '🎅', '⏰', '🕔', '🕙', '🕥', '⚽', '🐢', '🐷', '🤓', '⌛', '🎸', '🤘', '🌸', '🚺', '💟', '🙂', '⬜', '⬅', '🇱', '🍤', '📒', '📞', '🐙', '🚓', '🐈', '🐵', '😿', '👤', '🍼', '📣', '🚹', '🔞', '♣', '👕', '♦', '📚', '➕', '🏄', '🇻', '🈶', '⛵', '🐬', '🌝', '🔊', '🚗', '🕣', '☹', '💭', '🕯', '🚶', '🐦', '⁉', '💝', '⚪', '⛔', '🌏', '😾', '🎁', '💅', '☎', '🕛', '🔴', '😼', '🎓', '🏈', '🐀', '🎆', '⏳', '🌳', '🌶', '🐟', '🎧', '📲', '🌋', '🐣', '🚪', '👵', '📖', '💑', '♠', '✂', '💡', '🍾', '⌚', '🦀', '🐾', '👥', '🔯', '🚮', '🚑', '🍦', '🐥', '🏥', '🇰', '🏠', '🆒', '👠', '📱', '🐎', '🉐', '🚩', '👙', '🍏', '🍸', '🍳', '🐺', '☢', '👃', '🚔', '🐊', '🇽', '🐰', '🍊', '🙎', '💬', '🇫', '📕', '🙍', '🍬', '🍉', '🅾', '🌷', '🔦', '👾', '❎', '🏌', '🍒', '✡', '🏊', '⭕', '◻', '☔', '⚰', '🌱', '🤖', '👲', '💂', '➖', '♨', '🌠', '👣', '🗿', '🍫', '❕', '🔺', '🐤', '🍭', '🐮', '🍖', '🎄', '📯', '🐠', '💄', '⚓', '🍃', '🎯', 'ℹ', '🐲', '🌼', '🖐', '🐘', '🕐', '💆', '👷', '🇴', '❔', '🔜', '🍹', '🐨', '🔵', '🐩', '📈', '🏡', '🕵', '🅱', '♏', '📷', '🐭', '💐', '◾', '🚧', '🐋', '🤕', '🎥', '👰', '✝', '🍄', '🇯', '🇭', '🐄', '🌰', '📦', '🗡', '◼', '🍽', '🎮', '🔳', '🐯', '🌻', '✏', '🐑', '🌺', '🍵', '👞', '🐖', '⛽', '🆕', '🤐', '🇾', '🚿', '🌾', '🚼', '🐞', '🎀', '🔮', '🚷', '🏅', '⚔', '🌵', '🐌', '🍶', '◀', '🔙', '🚽', '🕑', '🍂', '🐉', '🔟', '🎲', '🚋', '✍', '📧', '🐇', '⛄', '🌮', '🐽', '🏋', '🍯', '🎟', '📠', '♿', '🤒', '📍', '💳', '🚁', '🏒', '🔚', '🐜', '🔒', '🛀', '👔', '♒', '🎹', '🙁', '🛫', '👗', '🌐', '🔎', '🍲', '🏇', '🎨', '🌭', '📹', '🍣', '💶', '🚒', '🦃', '⤵', '💽', '📸', '🔍', '📬', '☮', '☪', '🌀', '👢', '🔢', '🍠', '©', '💼', '🍜', '🇿', '🚙', '🏫', '🎇', '⏩', '🔄', '📉', '💴', '🕊', '🎻', '🛬', '🐗', '⚫', '🚴', '📟', '🚌', '🏳', '⏱', '🔇', '📘', '🏎', '📜', '⤴', '♎', '〰', '➰', '🎭', '🔌', '🎬', '🌑', '🔬', '🏚', '⚖', '🏁', '☣', '↩', '🔁', '🌛', '🚦', '↕', '🍧', '🆓', '🌅', '☃', '⛪', '🕒', '🗑', '☄', '🌜', '🔧', '🐂', '🔼', '▫', '🌧', '📛', '🔱', '🎾', '🗻', '🧀', '🐏', '🦁', '⚒', '🍥', '🖥', '💌', '💷', '🚸', '🖖', '🌬', '〽', '🎱', '📴', '🗓', '🏛', '🌕', '🚘', '🇼', '🔋', '🐆', '📆', '🎣', '🔐', '👛', '🛠', '🐹', '🌫', '📁', '🏹', '⛳', '👒', '🚜', '📗', '⛏', '🚕', '📵', '🕶', '⏬', '🔩', '📨', '♓', '📰', '🍈', '®', '🎙', '🛂', '🖒', '🕓', '🗨', '✉', '❣', '🐡', '🌪', '📑', '🌉', '✴', '🐅', '📃', '🚄', '🍱', '✒', '📄', '🎳', '🏪', '🌄', '👜', '🍙', '🕝', '🔘', '💹', '🔃', '👡', '🏩', '🚏', '🏤', '⛰', '🔷', '🕠', '🗾', '🏰', '🕖', '🍡', '🐪', '🔶', '❇', '🔆', '⛓', '📻', '♑', '🚢', '☘', '🌨', '🕰', '🕧', '👘', '🐚', '🔖', '🕳', '📶', '🌩', '🏉', '🍨', '🚅', '👚', '🎰', '📌', '☯', '🔓', '🌆', '🎚', '🖊', '🛌', '🍮', '🚛', '🏭', '🍛', '🐁', '🔽', '🏣', '↗', '🚖', '☂', '🔲', '🚾', '🚐', '🛡', '↔', '🚤', '🕜', '📽', '📂', '🔹', '🕹', '🔻', '🌡', '📼', '📀', '🕚', '📊', '↪', '🗯', '🕗', '⏫', '💠', '🕌', '🗼', '📓', '🅿', '⏲', '🛏', '⚙', '🏦', '🔏', '🍚', '🃏', '♐', '💈', '🛎', '🕦', '🤣', '🍿', '⌨', '🎫', '🕤', '🍐', '🐫', '🌯', '📤', '🏕', '💱', '🎎', '♌', '🈁', '🚞', '🎞', '🔗', '🚣', '🎢', '🔸', '📩', '♍', '🖇', '⛈', '🕴', '📪', '🎒', '🕘', '🔕', '🕋', '🎗', '⛅', '🏗', '↘', '🏜', '⏪', '📥', '📐', '🗝', '↖', '🎖', '🛩', '🌇', '🅴', '🏍', '🏂', '📙', '🖋', '🛐', '🚰', '🚵', '🚉', '🕟', '🎪', '🔀', '🎽', '🔉', '📎', '🎠', '✳', '🏖', '🚎', '🏐', '🚇', '🏙', '🏮', '📮', '🕕', '🇶', '🔈', '🎌', '🎛', '🉑', '🍘', '🌒', '🚈', '🆎', '🗞', '🚊', '🖱', '🚭', '🖲', '🌂', '🚯', '🕞', '💮', '🐿', '📔', '⛸', '🎐', '↙', '🖓', '🎑', '🌔', '🏨', '🔂', '🕸', '🎡', '🦂', '♈', '🎿', '🚻', '🌗', '⚜', '🏘', '🌖', '📏', '🌘', '🛁', '🌓', '👝', '🍢', '🏧', '🖨', '🎋', '🏵', '⛷', '🕢', '🕷', '🗳', '➗', '🚝', '🏯', '⛲', '🏞', '🚆', '🔅', '⛹', '🕡', '🏏', '🖑', '🆃', '⛑', '🈵', '⛴', '🏬', '🖍', '◽', '🚱', '🛢', '♉', '⚱', '⚗', '📿', '⏯', '🗺', '📭', '🖼', '🕎', '🚥', '🗃', '⛎', '㊙', '➿', '🔣', '🆂', '🛳', '📫', '🔠', '🏓', '🚍', '🈳', '🕍', '🛅', '🗜', '🏸', '🕉', '🛣', '⏹', '📋', '🛍', '㊗', '🈲', '🛃', '🏔', '🎍', '🛥', '🔤', '🌤', '🛋', '🆁', '🌦', '⚛', '⛱', '🈷', '🚡', '☦', '🎏', '🀄', '🤢', '🔡', '🈚', '🚠', '🏝', '🏑', '🏺', '🔰', '🅸', '☸', '🖌', '🏷', '⏭', '🈴', '🏟', '🤷', '🎦', '🛄', '🌥', '🈯', '🎴', '📳', '🚳', '🆄', '🗄', '🗒', '🏴', '🅷', '🈹', '🌁', '🤙', '⏸', '🗂', '🤤', '⏮', '⛩', '🦑', '🚟', '🦇', '🈺', '🛤', '🅞', '📇', '🅵', '🅔', '🖎', '🅢', '⏺', '🤵', '🅣', '🅳', '🈸', '🆚', '🤦', '🦍', '🥓', '🅶', '🂡', '🤠', '🦲', '🅝', '🥚', '🅘', '🤡', '🅡', '🅐', '🅗', '🄴', '🤺', '🥊', '🅛', '🄲', '🕿', '🥒', '🄸', '🅚', '🅤', '🅦', '🦋', '🖙', '🅒', '🄽', '🆇', '🤴', '🤧', '🄷', '🤚', '🤳', '🅓', '🗩', '🗵', '🖚', '🥕', '🥜', '🤞', '🗶', '🅹', '🥗', '🥙', '🢫', '🄶', '🢡', '🅕', '🅖', '🥘', '🥖', '🄱', '🅑', '🆀', '🠖', '🄰', '🡆', '🦐', '🖘', '🤛', '🢧', '🠊', '🤝', '🠦', '🠢', '🠂', '🤌', '🤜', '🄼', '🡂', '🠪', '🡒', '🢂', '🢒', '🠲', '🥔', '🢣', '🡪', '🡲', '🥉', '🅙', '🡺', '🠮', '🠾', '🧃', '🄵', '🗫', '🄹', '🢖', '🥞', '🈈', '🢩', '🠆', '🄺', '🗭', '🈃', '🠞', '🅥', '🗲', '🖗', '🠚', '🢥', '🠶', '🡢', '🢚', '🥥', '🝌', '🅟']

def sample(prime, chars, sess, vocab, model):
    chars_list, probs = model.rawsample(sess, chars, vocab, prime)

    best_char = ' '
    best_prob = 0

    for i in range (0, len(chars_list)):
        if chars_list[i] in emojis:
            if probs[i] > best_prob:
                best_char = chars_list[i]
                best_prob = probs[i]
                print("new best char is " + best_char)
                print(probs[i])

    print(best_char)

if __name__ == '__main__':
    main()
